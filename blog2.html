<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>My portifolio website</title>
        <link rel="stylesheet" type="text/css" href="/blog2.css">
        
        <link rel="stylesheet"
        href='https://unpkg.com/boxicons@latest/css/boxicons.min.css'>
    
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    </head>
<body>
    <header>
        <a href="#" class="logo">ZED<span>Art</span></a>
        <div class="bx bx-menu" id="menu-icon"></div>

        <ul class="navbar">
            <li><a href="/index.html">home</a></li>
            <li><a href="/about.html">About</a></li>
            <li><a href="/portifolio.html">Portifolio</a></li>
            <li><a href="/blog.html">Blogs</a></li>
            <li><a href="/contact.html">contact</a></li>
            <li><a href="/Login.html" id="dashboard">Login</a></li>
        </ul>
    </header>

    <div class="skills-heading">
        <h4></h4>
    </div>

    <div id="singleblog">
      <div class="gridi" id="blog_side">
          

      </div>
   
    </div>

    <div class="row">
        <i class='bx bx-like'  id="like"></i>
        <i class='bx bx-message'>10</i>
    </div>
   

    <div id="comment-form">
      
        <form>
          <input type="text" id="name" placeholder="enter username" required>
          <textarea id="comment-text" placeholder="Write your comment here" required></textarea>
          <button type="submit" id="submit-button">Send Comment</button>
        </form>
        <div class="comments-display">
          
        </div>
    </div>
   
   </main>
 <footer>
    <div class="footer">
        <div class="classname">
        @coppyright 2022 - ZEDArt    <a href="./contact me.html">kwizeraernez@gmail.com</a><br><span>+250781963232</span>
        </div>
    </div>
 </footer>
 <script>
    let menu = document.querySelector('#menu-icon');
    let navbar = document.querySelector('.navbar')
    
    menu.onclick = () => {
      menu.classList.toggle('bx-x');
      navbar.classList.toggle('active');
    };
    
    window.onscroll = () => {
      menu.classList.remove('bx-b');
      navbar.classList.remove('active');
    }
 
</script>

<script>
const idea = document.getElementById('comment-text')
const name = document.getElementById('name')
const send = document.querySelector('#submit-button')
send.addEventListener('click', (event) => {
 event.preventDefault()
 let blog_id = location.href.split('=')[1];
 let date = new Date().getDate() + '/' + (new Date().getMonth() + 1) + '/' + new Date().getFullYear();
    let Time = new Date().getHours() + ' : ' + new Date().getMinutes() + ' : ' + new Date().getSeconds();
    let username = name.value
    let Comment = idea.value
    let comment = {
        date,
        Time,
        username,
        Comment
    }
    console.log(comment)
  const  newData ={
    method:'POST',
    headers:{
      'Content-Type':"application/json"
    },
    body: JSON.stringify(comment)
  }
  console.log(newData)
fetch(`https://zedart-api.onrender.com/blogs/comments/${blog_id}`,newData)
.then((n)=>{
  const res = n.json()
  console.log(res)
  if(n.status == 200){
   alert("Comment Added!!")
   location.reload()
   
  }

}).catch(error=>{
  console.log(error)
})
})


const display_1_comment = async() =>{
  const comment_displays = document.querySelector(".comments-display");
   console.log(comment_displays)
    let blog_id = location.href.split("=")[1];
    console.log(blog_id)
    const response = await fetch(`https://zedart-api.onrender.com/blogs/allComments/${blog_id}`, {
      method: "GET"
    });
    const comment = await response.json();
    
      comment_displays.innerHTML += `<div class="onecomment">
      <h2>${comment.date}</h2>
      <h4>${comment.username}</h4><br>
      <p>${comment.Comment}</p>
      
      </div> `
}

display_1_comment()

const dashboard = document.querySelector('#dashboard')
    const adminToken = localStorage.getItem('adminToken')
    function LoginAdmin(){
        if(!adminToken){}
        else{
           
            const link =  document.querySelector(".navbar")
            console.log(link)
            const dashi = document.createElement('li')
            const dash = document.createElement('a')
            dash.setAttribute('href','./admin/homedashboad.html')
            dash.innerHTML = "dashbord"
            dashi.append(dash)
            link.append(dashi)
            dashboard.innerHTML = "logout"
            dashboard.parentElement.remove()
        }
    }

    LoginAdmin()

    const userToken = localStorage.getItem('userToken')
    function LoginUser(){
        if(!userToken){}
        else{
            dashboard.innerHTML = "Logout"

        }
    }

    LoginUser()

</script>
 <script src="/javascript/blog.js"></script>

</body>
</html>