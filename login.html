<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>My portifolio website</title>
        <link rel="stylesheet" type="text/css" href="/login.css">
        
        <link rel="stylesheet"
        href='https://unpkg.com/boxicons@latest/css/boxicons.min.css'>
    
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    </head>
<body>
    <header>
        <a href="#" class="logo">ZED<span>Art</span></a>
        <div class="bx bx-menu" id="menu-icon"></div>

        <ul class="navbar">
            <li><a href="/index.html">home</a></li>
            <li><a href="/about.html">About</a></li>
            <li><a href="/portifolio.html">Portifolio</a></li>
            <li><a href="/blog.html">Blogs</a></li>
            <li><a href="/contact.html">contact</a></li>
            <li><a href="/Login.html">Login</a></li>
        </ul>
    </header> 
    <div class="wrapper">
        <Form Class="Form-1">
            <H1>Login</H1>
            <Input Type="text" Name="Username" placeholder="Enter username" Id="Username" required/>
            <Input Type="Email" Name="Email" placeholder="Enter your email" Id="Email"  required/>
            <Input Type="Password" Name="Password" placeholder="Enter password" Id="Password"  required/>
            <div id="forgot">
                <p><a href="#">forgot password?</a></span></p>
            </div>
            <section id="butto">
                <input type="submit" value="login" class="button1"> 
            </section>
            <div class="member">
                if you don't have account<a href="/signup.html">signup</a>
            </div>
      </Form>
</div>
    </div>
    <footer>
        <div class="footer">
            <div class="classname">
            @coppyright 2022 - ZEDArt    <a href="./contact me.html">kwizeraernez@gmail.com</a><br><span>+250781963232</span>
            </div>
        </div>
    </footer>
    <script>
    const Login = document.querySelector('.button1')
    Login.addEventListener('click', async(event) => {
        event.preventDefault()
     var loginData = {
    username:document.getElementById('Username').value,
    email: document.getElementById('Email').value,
    password: document.getElementById('Password').value
    };
    try {
        const response = await fetch('https://zedart-api.onrender.com/users/login',{
            method: 'POST',
            headers:{
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(loginData)
        })
        const res = await response.json();
        if(res){
            if (res.role == 'user') {
                const userToken = res.token;
                localStorage.setItem('userToken', userToken);
                const successMsg = 'Wellcome to ZEDArt! now you can like and comment to our Blogs...';
                alert(successMsg)
                window.location.href="index.html"
            }else if(res.role == "admin"){
                const userData = {
                    name: res.name,
                    token: res.token
                }
                localStorage.setItem('adminToken', JSON.stringify(userData));
                alert("Admin welcome Again!!")
                window.location.href="admin/homedashboad.html"
             
            }
            else{
                alert('Wrong input email or password! try again or Signup..')
            }
        }
    } catch (error) {
        console.log('Wrong input email or password')
    }

    })
    </script>
<!-- <script>
    const Login = document.querySelector('.button1')
    Login.addEventListener('click', (event) => {
    event.preventDefault()
     var loginData = {
    username:document.getElementById('Username').value,
    email: document.getElementById('Email').value,
    password: document.getElementById('Password').value
  };
const  newData ={
    method:'POST',
    headers:{
      'Content-Type':"application/json"
    },
    body: JSON.stringify(loginData)
  }
 // console.log(newData)
fetch("https://zedart-api.onrender.com/users/login",newData)
.then( async (n)=>{
  const res =  await n.json()
  try {
    
  } catch (error) {
    
  }
  let k = res.token
  console.log(res)
  if(res.role == "admin"){
  alert('You logged in as Admin')
//   location.reload()
//    window.location.href="admin/homedashboad.html"
  localStorage.setItem('token',res.token)
  }
  else{
    alert("welcome to ZEDArt!")
//    location.reload()
//    window.location.href="index.html"
  }
}).catch(error=>{
  console.log(error)
})
    })
</script> -->
<script src="/javascript/login.js"></script>
</body>
</html>